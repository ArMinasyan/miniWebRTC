(this.webpackJsonpvc=this.webpackJsonpvc||[]).push([[0],{47:function(e,t,n){e.exports=n(87)},52:function(e,t,n){},79:function(e,t){},87:function(e,t,n){"use strict";n.r(t);var o=n(0),c=n.n(o),a=n(43),r=n.n(a),i=(n(52),n(3)),s=n.n(i),u=n(7),l=n(9),d=n(19),m=n.n(d),f=n(44),p=n.n(f);var v=function(){var e,t,n,a,r=Object(o.useState)(),i=Object(l.a)(r,2),d=i[0],f=i[1],v=Object(o.useState)({}),g=Object(l.a)(v,2),b=(g[0],g[1],Object(o.useState)({})),w=Object(l.a)(b,2),h=(w[0],w[1],Object(o.useState)("")),k=Object(l.a)(h,2),E=(k[0],k[1],m()("https://rtc-test-11.herokuapp.com/")),y=[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"}],C=document.getElementById("room-selection-container"),j=(document.getElementById("room-input"),document.getElementById("connect-button"),document.getElementById("video-chat-container")),x=document.getElementById("local-video"),O=document.getElementById("remote-video"),_={audio:!1,video:{width:1280,height:720}},S=function(e){p()({title:"Error",text:e,icon:"error",buttons:{confirm:{text:"OK"}}})},I=function(){var e;""===(e=d)?alert("Please type a room ID"):(a=e,E.emit("join",e),C.style="display: none",j.style="display: block")};function D(e){return R.apply(this,arguments)}function R(){return(R=Object(u.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then((function(t){e=t,x.srcObject=t})).catch((function(e){S(e.toString())}))}catch(n){console.error("Could not get user media",n)}case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function T(t){e.getTracks().forEach((function(n){t.addTrack(n,e)}))}function B(e){return L.apply(this,arguments)}function L(){return(L=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createOffer();case 3:n=e.sent,t.setLocalDescription(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:E.emit("webrtc_offer",{type:"webrtc_offer",sdp:n,roomId:a});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function P(e){return A.apply(this,arguments)}function A(){return(A=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createAnswer();case 3:n=e.sent,t.setLocalDescription(n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:E.emit("webrtc_answer",{type:"webrtc_answer",sdp:n,roomId:a});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function M(e){O.srcObject=e.streams[0],e.stream}function V(e){e.candidate&&E.emit("webrtc_ice_candidate",{roomId:a,label:e.candidate.sdpMLineIndex,candidate:e.candidate.candidate})}return E.on("room_created",Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Socket event callback: room_created"),e.next=3,D(_);case 3:t=!0;case 4:case"end":return e.stop()}}),e)})))),E.on("room_joined",Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Socket event callback: room_joined"),e.next=3,D(_);case 3:E.emit("start_call",a);case 4:case"end":return e.stop()}}),e)})))),E.on("full_room",(function(){console.log("Socket event callback: full_room"),alert("The room is full, please try another one")})),E.on("start_call",Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Socket event callback: start_call"),!t){e.next=8;break}return T(n=new RTCPeerConnection(y)),n.ontrack=M,n.onicecandidate=V,e.next=8,B(n);case 8:case"end":return e.stop()}}),e)})))),E.on("webrtc_offer",function(){var e=Object(u.a)(s.a.mark((function e(o){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Socket event callback: webrtc_offer"),t){e.next=9;break}return T(n=new RTCPeerConnection(y)),n.ontrack=M,n.onicecandidate=V,n.setRemoteDescription(new RTCSessionDescription(o)),e.next=9,P(n);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),E.on("webrtc_answer",(function(e){console.log("Socket event callback: webrtc_answer"),n.setRemoteDescription(new RTCSessionDescription(e))})),E.on("webrtc_ice_candidate",(function(e){var t=new RTCIceCandidate({sdpMLineIndex:e.label,candidate:e.candidate});n.addIceCandidate(t)})),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{id:"room-selection-container",className:"centered"},c.a.createElement("input",{id:"room-input",type:"text",onChange:function(e){return f(e.target.value)}}),c.a.createElement("button",{id:"connect-button",onClick:function(e){return I()}},"CALL"),c.a.createElement("button",{id:"connect-button",onClick:function(e){}},"ANSWER")),c.a.createElement("div",{id:"video-chat-container",className:"video-position"},c.a.createElement("video",{id:"local-video",autoPlay:!0,muted:"muted"}),c.a.createElement("video",{id:"remote-video",autoPlay:!0})))};var g=function(){var e=Object(o.useState)(""),t=Object(l.a)(e,2),n=t[0],a=t[1],r=m()("https://rtc-test-11.herokuapp.com/"),i=document.getElementById("localVideo"),s=document.getElementById("remoteVideo"),u=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"}]});r.on("room_created",(function(){console.log("Room Created: ",n),d(u)})),r.on("room_joined",(function(){console.log("Room Joined: ",n),d(u)})),r.on("offer",(function(e){console.log("Offer"),u.setRemoteDescription(new RTCSessionDescription(e))})),r.on("answer",(function(e){console.log("Answer"),u.setRemoteDescription(new RTCSessionDescription(e))})),u.ontrack=function(e){s.srcObject=e.streams[0]},r.on("candidate",(function(e){u.addIceCandidate(e.candidate)}));var d=function(e){navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((function(t){i.srcObject=t,t.getTracks().forEach((function(n){e.addTrack(n,t)}))}))};return c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{type:"text",value:n,onChange:function(e){return a(e.target.value)}}),c.a.createElement("button",{onClick:function(e){r.emit("join",n)}},"Connect"),c.a.createElement("button",{onClick:function(e){return u.createOffer().then((function(e){u.setLocalDescription(new RTCSessionDescription(e)),r.emit("offer",{id:n,offer:e})})),void(u.onicecandidate=function(e){e.candidate&&r.emit("candidate",{id:n,candidate:e.candidate,irc:!0})})}},"Call"),c.a.createElement("button",{onClick:function(e){return u.createAnswer().then((function(e){u.setLocalDescription(new RTCSessionDescription(e)),r.emit("answer",{id:n,answer:e})})),void(u.onicecandidate=function(e){e.candidate&&r.emit("candidate",{id:n,candidate:e.candidate})})}},"Answer"),c.a.createElement("br",null),c.a.createElement("video",{id:"localVideo",autoPlay:!0,height:200}),c.a.createElement("video",{id:"remoteVideo",autoPlay:!0,height:200}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var b=n(45),w=n(1);r.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(b.a,null,c.a.createElement(w.c,null,c.a.createElement(w.a,{exact:!0,path:"/",component:v}),c.a.createElement(w.a,{exact:!0,path:"/app1",component:g})))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[47,1,2]]]);
//# sourceMappingURL=main.73c4f652.chunk.js.map